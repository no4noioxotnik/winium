use opendb Declare @p_date	datetime ,@year	int ,@error_message varchar(255) select @year = YEAR(@p_date) begin if not exists (   select top 1 * from opendb.dbo.planned_transactions PT (nolock) where PT.account  = 73 and PT.comment like ('%' + cast(@year as varchar(255)) + '%') and PT.status_id = 3) select @error_message = 'Отсутсвуют начисления по налогам'raiserror(@error_message, 15, 6) end